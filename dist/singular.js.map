{"version":3,"sources":["singular.js"],"names":["singular","singularInit","window","document","undefined","location","START_PATH","href","ORIGIN","origin","FROM","Array","from","READY_CALLBACKS","LOAD_CALLBACKS","UNLOAD_CALLBACKS","CONFIGURE","development","elementIds","classSelectors","enableKeepHtml","enableKeepStyles","enableSearchString","enableHashString","START_HTML","documentElement","outerHTML","SERIES_CALLBACKS","PARALLEL_CALLBACKS","RENDERED_STYLES","RENDERED_SCRIPTS","LOADED","CURRENT_PATH","ABORTER","Page","State","PAGES","addEventListener","singularOnClick","event","node","target","tagName","_singularAnchor","anchor","closest","rawHref","getAttribute","startsWith","download","stopPropagation","preventDefault","inlineOutlet","dataset","outlet","route","split","singularOnPopstate","state","singularOnDOMContentLoaded","getHref","style","visibility","onLoad","configure","indexOf","Object","assign","link","tag","promise","Promise","resolve","resolver","onload","onerror","rel","head","append","src","async","script","callback","length","body","store","enterCallbacks","exitCallbacks","requestUrl","reason","console","warn","replace","end","current","createElement","byId","id","getElementById","fragmentHtml","html","fragment","createDocumentFragment","appendChild","innerHTML","getStyles","styleEntries","entries","styleUrls","urls","getScripts","scriptEntries","scriptUrls","url","page","title","styles","scripts","links","setAttribute","routeAfterFirstRouted","apply","arguments","callbacks","concat","abort","scrollTo","render","pushState","request","then","responseUrl","parse","AbortController","fetch","signal","responseText","catchError","response","all","text","history","rawHtml","getElementsByTagName","innerText","classMap","selector","className","parentNode","removeChild","targetHTML","querySelector","join","classes","URL","pathname","endsWith","substring","hash","search","getScriptUrl","changeAll","replaceMap","to","replaceChild","children","addScript","addStyle","elements","importPromises","removeStyles","renderedStyleHrefs","keys","getResources","parentElement","attributeName","nodes","querySelectorAll","value","getFixedUrl","attribute","series","prepares","onLoading","catchReload","onLoaded","reload","changedElement","splice"],"mappings":"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","sourcesContent":["\"use strict\";\nconst singular = (function singularInit(window, document, undefined) {\n    const { href: START_PATH, origin: ORIGIN } = location;\n    const { from: FROM } = Array;\n    const READY_CALLBACKS = [];\n    const LOAD_CALLBACKS = [];\n    const UNLOAD_CALLBACKS = [];\n    let CONFIGURE = {\n        development: false,\n        elementIds: null,\n        classSelectors: null,\n        enableKeepHtml: false,\n        enableKeepStyles: false,\n        enableSearchString: false,\n        enableHashString: false\n    };\n    let START_HTML = document.documentElement.outerHTML;\n    let SERIES_CALLBACKS = [];\n    let PARALLEL_CALLBACKS = [];\n    let RENDERED_STYLES = {};\n    let RENDERED_SCRIPTS = {};\n    let LOADED = false;\n    let CURRENT_PATH = START_PATH;\n    let ABORTER;\n    class Page {\n        url;\n        title;\n        styles;\n        scripts;\n        enterCallbacks = [];\n        exitCallbacks = [];\n        classes;\n        html;\n    }\n    class State {\n        singular;\n        constructor(href) {\n            this.singular = {\n                href\n            };\n        }\n    }\n    const PAGES = {\n        [START_PATH]: new Page\n    };\n    addEventListener('click', function singularOnClick(event) {\n        let node = event.target;\n        switch (node.tagName) {\n            case 'BODY':\n                return false;\n            case 'A':\n                break;\n            default:\n                if (node._singularAnchor === false) {\n                    return true;\n                }\n                const anchor = node.closest('a');\n                if (!anchor || !anchor.href) {\n                    node._singularAnchor = false;\n                    return true;\n                }\n                node = anchor;\n        }\n        const { href } = node;\n        const rawHref = node.getAttribute('href');\n        if (!href.startsWith(ORIGIN)\n            || node.download\n            || (rawHref && rawHref.startsWith('#'))) {\n            node._singularAnchor = false;\n            return true;\n        }\n        node._singularAnchor = node;\n        event.stopPropagation();\n        event.preventDefault();\n        const inlineOutlet = node.dataset?.outlet;\n        singular.route(href, inlineOutlet ? inlineOutlet.split(',') : undefined);\n        return false;\n    });\n    addEventListener('popstate', function singularOnPopstate(event) {\n        const { state } = event;\n        if (state && state.singular) {\n            route(state.singular.href);\n        }\n        return true;\n    });\n    addEventListener('DOMContentLoaded', function singularOnDOMContentLoaded() {\n        CURRENT_PATH = getHref(START_PATH);\n        if (START_PATH !== CURRENT_PATH) {\n            PAGES[CURRENT_PATH] = PAGES[START_PATH];\n            delete PAGES[START_PATH];\n        }\n        document.documentElement.style.visibility = 'hidden';\n        onLoad();\n    });\n    return class Singular {\n        /**\n         * Set Configure\n         * @param configure\n         */\n        static configure(configure) {\n            const { elementIds, classSelectors } = configure;\n            if (elementIds) {\n                if (typeof elementIds === 'string') {\n                    configure.elementIds = [elementIds];\n                }\n                if (elementIds.indexOf('body') > -1) {\n                    configure.elementIds = null;\n                }\n            }\n            if (classSelectors) {\n                if (typeof classSelectors === 'string') {\n                    configure.classSelectors = [classSelectors];\n                }\n            }\n            CONFIGURE = Object.assign(CONFIGURE, configure);\n            return this;\n        }\n        /**\n         * Add External Stylesheet to <HEAD> Using <LINK>\n         * @param href\n         */\n        static addStyle(href) {\n            const link = tag('link');\n            return {\n                link,\n                promise: new Promise((resolve) => {\n                    const resolver = () => resolve();\n                    link.onload = resolver;\n                    link.onerror = resolver;\n                    link.rel = 'stylesheet';\n                    document.head.append(link);\n                    link.href = href;\n                })\n            };\n        }\n        ;\n        /**\n         *  Add External Stylesheet to <HEAD> Using <SCRIPT>\n         * @param src\n         * @param async\n         */\n        static addScript(src, async = true) {\n            const script = tag('script');\n            return {\n                script,\n                promise: new Promise((resolve) => {\n                    const resolver = () => resolve();\n                    script.onload = resolver;\n                    script.onerror = resolver;\n                    script.async = async;\n                    document.head.append(script);\n                    script.src = src;\n                })\n            };\n        }\n        ;\n        /**\n         * Set Parallel Callback for Bootstrap\n         * @description\n         *   Callbacks Call as Multiple Thread\n         * @param callback\n         */\n        static parallel(callback) {\n            PARALLEL_CALLBACKS[PARALLEL_CALLBACKS.length] = callback;\n            return this;\n        }\n        /**\n         * Set Series Callback for Bootstrap\n         * @description\n         *   Callbacks Call as Single Thread\n         *   If Previous Callback to failed, Does not Move to Next Callback.\n         * @param callback\n         */\n        static series(callback) {\n            SERIES_CALLBACKS[SERIES_CALLBACKS.length] = callback;\n            return this;\n        }\n        /**\n         * Run Once in Declared Document after DOMContentLoaded\n         * @param callback\n         */\n        static ready(callback) {\n            READY_CALLBACKS[READY_CALLBACKS.length] = callback;\n            if (LOADED) {\n                callback(document.body);\n            }\n            return this;\n        }\n        /**\n         * Run Everytime in Every Document after DOMContentLoaded\n         * @param callback\n         */\n        static load(callback) {\n            LOAD_CALLBACKS[LOAD_CALLBACKS.length] = callback;\n            if (LOADED) {\n                callback(document.body);\n            }\n            return this;\n        }\n        /**\n         * Run Everytime in Declared Document after DOMContentLoaded\n         * @alias singular\n         * @param callback\n         */\n        static enter(callback) {\n            const store = PAGES[CURRENT_PATH].enterCallbacks;\n            store[store.length] = callback;\n            if (LOADED) {\n                callback(document.body);\n            }\n            return this;\n        }\n        /**\n         * Run Everytime in Declared Document after beforeunload\n         * @param callback\n         */\n        static exit(callback) {\n            const { exitCallbacks } = PAGES[CURRENT_PATH];\n            exitCallbacks[exitCallbacks.length] = callback;\n            return this;\n        }\n        ;\n        static unload(callback) {\n            UNLOAD_CALLBACKS[UNLOAD_CALLBACKS.length] = callback;\n            return this;\n        }\n        /**\n         * Move to Other Document\n         * @param requestUrl\n         * @param elementIds\n         */\n        static route(requestUrl, elementIds) {\n            try {\n                route(requestUrl, elementIds);\n            }\n            catch (reason) {\n                console.warn(reason);\n                if (!CONFIGURE.development) {\n                    location.replace(requestUrl);\n                }\n                return null;\n            }\n        }\n        /**\n         * Signal for DOM Changed by any codes\n         * @param target\n         */\n        static changed(target = document.body) {\n            const end = LOAD_CALLBACKS.length;\n            let current = -1;\n            while (++current < end) {\n                LOAD_CALLBACKS[current](target);\n            }\n            return this;\n        }\n    };\n    function tag(tagName) {\n        return document.createElement(tagName);\n    }\n    function byId(id) {\n        return document.getElementById(id);\n    }\n    function fragmentHtml(html) {\n        const fragment = document.createDocumentFragment();\n        const fragmentHtml = tag('html');\n        fragment.appendChild(fragmentHtml);\n        fragmentHtml.innerHTML = html;\n        return fragmentHtml;\n    }\n    function route(requestUrl, elementIds) {\n        const { entries: styleEntries, urls: styleUrls } = getStyles(document.documentElement);\n        const { entries: scriptEntries, urls: scriptUrls } = getScripts(document.documentElement);\n        let end = styleEntries.length;\n        let current = -1;\n        while (++current > end) {\n            const [node, url] = styleEntries[current];\n            RENDERED_STYLES[url] = node;\n        }\n        end = scriptEntries.length;\n        current = -1;\n        while (++current < end) {\n            const [node, url] = scriptEntries[current];\n            RENDERED_SCRIPTS[url] = node;\n            document.head.append(node);\n        }\n        const page = PAGES[getHref(START_PATH)];\n        page.url = START_PATH;\n        page.title = document.title;\n        page.styles = styleUrls;\n        page.scripts = scriptUrls;\n        page.html = START_HTML;\n        START_HTML = null;\n        const { links } = document;\n        current = links.length;\n        while (current-- > 0) {\n            const anchor = links[current];\n            const href = anchor.getAttribute('href');\n            if (!href || !(href.startsWith('./') || href.startsWith('../'))) {\n                continue;\n            }\n            anchor.setAttribute('href', anchor.href);\n        }\n        // @ts-ignore\n        return (route = routeAfterFirstRouted).apply(this, arguments);\n        function routeAfterFirstRouted(requestUrl, elementIds) {\n            // console.debug(`[singular] ${href}`);\n            if (LOADED) {\n                const callbacks = PAGES[CURRENT_PATH].exitCallbacks.concat(UNLOAD_CALLBACKS);\n                const end = callbacks.length;\n                let current = -1;\n                try {\n                    while (++current < end) {\n                        callbacks[current]();\n                    }\n                }\n                catch (reason) {\n                    console.warn(reason);\n                }\n            }\n            else if (ABORTER) {\n                ABORTER.abort();\n            }\n            window.scrollTo(0, 0);\n            // document.title = requestUrl.substring(requestUrl.indexOf(':') + 3);\n            LOADED = false;\n            CURRENT_PATH = getHref(requestUrl);\n            const page = PAGES[CURRENT_PATH];\n            if (page) {\n                if (CONFIGURE.enableKeepHtml) {\n                    render(page);\n                    pushState(page.url);\n                }\n                else {\n                    // noinspection JSUnusedLocalSymbols\n                    request(requestUrl)\n                        .then(([responseUrl, html]) => {\n                        page.html = html;\n                        render(page);\n                    });\n                }\n            }\n            else {\n                request(requestUrl)\n                    .then(([responseUrl, html]) => {\n                    parse(requestUrl, responseUrl, html, elementIds || CONFIGURE.elementIds);\n                });\n            }\n        }\n        function request(href) {\n            ABORTER = new AbortController();\n            return fetch(href, {\n                signal: ABORTER.signal\n            })\n                .then(responseText)\n                .catch(catchError);\n        }\n        function responseText(response) {\n            const { url } = response;\n            pushState(url);\n            return Promise.all([\n                Promise.resolve(url),\n                response.text()\n            ]);\n        }\n        function catchError(reason) {\n            console.warn(reason);\n        }\n        function pushState(url) {\n            history.pushState(new State(url), url, url);\n        }\n    }\n    function parse(requestUrl, responseUrl, rawHtml, elementIds) {\n        const fragment = fragmentHtml(rawHtml);\n        const title = (fragment.getElementsByTagName('TITLE')[0] || {}).innerText || requestUrl;\n        const { classSelectors } = CONFIGURE;\n        let current;\n        let classMap = null;\n        if (classSelectors) {\n            classMap = {};\n            current = classSelectors.length;\n            while (current-- > 0) {\n                const selector = classSelectors[current];\n                classMap[selector] = (fragment.getElementsByTagName(selector)[0] || {}).className || '';\n            }\n        }\n        const { urls: styleUrls } = getStyles(fragment);\n        const { entries: scriptEntries, urls: scriptUrls } = getScripts(fragment);\n        current = scriptEntries.length;\n        while (current-- > 0) {\n            const [node] = scriptEntries[current];\n            if (node?.parentNode) {\n                node.parentNode.removeChild(node);\n            }\n        }\n        let html;\n        if (elementIds) {\n            const targetHTML = [];\n            let current = elementIds.length;\n            while (current-- > 0) {\n                const target = fragment.querySelector('#' + elementIds[current]);\n                if (target) {\n                    targetHTML[targetHTML.length] = target.outerHTML;\n                }\n            }\n            html = targetHTML.join('');\n        }\n        else {\n            html = fragment.outerHTML;\n        }\n        const page = new Page;\n        page.url = responseUrl;\n        page.title = title;\n        page.styles = styleUrls;\n        page.scripts = scriptUrls;\n        page.classes = classMap;\n        page.html = html;\n        const url = new URL(CURRENT_PATH);\n        if (url.pathname.endsWith('/')) {\n            url.pathname = url.pathname.substring(0, url.pathname.length - 1);\n        }\n        PAGES['' + url] = page;\n        render(page);\n    }\n    function getHref(href) {\n        const url = new URL(href);\n        if (!CONFIGURE.enableHashString) {\n            url.hash = '';\n        }\n        if (!CONFIGURE.enableSearchString) {\n            url.search = '';\n        }\n        let { pathname } = url;\n        if (pathname.endsWith('/')) {\n            url.pathname = pathname.substring(0, pathname.length - 1);\n        }\n        return '' + url;\n    }\n    function getScriptUrl(href) {\n    }\n    function render(page) {\n        const { url, title, styles, scripts, classes, html } = page;\n        const { elementIds, classSelectors } = CONFIGURE;\n        document.title = title || url.substring(url.indexOf('://') + 3);\n        if (classSelectors && classes) {\n            let current = classSelectors.length;\n            while (current-- > 0) {\n                const selector = classSelectors[current];\n                const target = document.documentElement.querySelector(selector);\n                if (target) {\n                    target.className = classes[selector];\n                }\n            }\n        }\n        const fragment = fragmentHtml(html);\n        let changeAll = false;\n        if (elementIds) {\n            const replaceMap = [];\n            let current = elementIds.length;\n            while (current-- > 0) {\n                const selector = elementIds[current];\n                const from = fragment.querySelector('#' + selector);\n                const to = byId(selector);\n                if (!from || !to) {\n                    changeAll = true;\n                    break;\n                }\n                replaceMap[replaceMap.length] = [from, to];\n            }\n            if (!changeAll) {\n                current = replaceMap.length;\n                while (current-- > 0) {\n                    const [from, to] = replaceMap[current];\n                    to.parentNode.replaceChild(from, to);\n                }\n            }\n        }\n        else {\n            changeAll = true;\n        }\n        if (changeAll) {\n            document.body.innerHTML = '';\n            document.body.append(...(fragment.getElementsByTagName('BODY')[0] || fragment).children);\n        }\n        fragment.innerHTML = '';\n        const { addScript, addStyle } = singular;\n        const elements = [];\n        const importPromises = [Promise.resolve()];\n        const removeStyles = [];\n        let end;\n        let current;\n        if (!CONFIGURE.enableKeepStyles) {\n            const renderedStyleHrefs = Object.keys(RENDERED_STYLES);\n            current = renderedStyleHrefs.length;\n            while (current-- > 0) {\n                let href = renderedStyleHrefs[current];\n                if (styles.indexOf(href) > -1) {\n                    continue;\n                }\n                // RENDERED_STYLES[href].disabled = true;\n                removeStyles[removeStyles.length] = RENDERED_STYLES[href];\n                delete RENDERED_STYLES[href];\n            }\n        }\n        // add external stylesheet\n        end = styles.length;\n        current = -1;\n        while (++current < end) {\n            const href = styles[current];\n            if (RENDERED_STYLES[href]) {\n                //     RENDERED_STYLES[href].disabled = false;\n                continue;\n            }\n            const { link, promise } = addStyle(href);\n            RENDERED_STYLES[href] = link;\n            importPromises[importPromises.length] = promise;\n            elements[elements.length] = link;\n        }\n        // add external script\n        end = scripts.length;\n        current = -1;\n        while (++current < end) {\n            const src = scripts[current];\n            if (RENDERED_SCRIPTS[src]?.parentNode) {\n                // console.log(RENDERED_SCRIPTS[src], RENDERED_SCRIPTS[src].parentNode);\n                continue;\n            }\n            const { script, promise } = addScript(src);\n            RENDERED_SCRIPTS[src] = script;\n            importPromises[importPromises.length] = promise;\n            elements[elements.length] = script;\n        }\n        if (elements.length) {\n            document.head.append(...elements);\n        }\n        Promise.all(importPromises)\n            .then(() => {\n            let current = removeStyles.length;\n            while (current-- > 0) {\n                const link = removeStyles[current];\n                if (link && link.parentNode) {\n                    link.parentNode.removeChild(link);\n                }\n            }\n            onLoad();\n        });\n    }\n    function getResources(parentElement, selector, attributeName) {\n        const entries = [];\n        const urls = [];\n        const nodes = FROM(parentElement.querySelectorAll(selector));\n        const end = nodes.length;\n        let current = -1;\n        while (++current < end) {\n            const node = nodes[current];\n            if (!node.getAttribute(attributeName) || node[attributeName].startsWith(ORIGIN)) {\n                continue;\n            }\n            const value = getFixedUrl(node, attributeName);\n            entries[entries.length] = [node, value];\n            urls[urls.length] = value;\n        }\n        return { entries, urls };\n    }\n    function getStyles(parentElement) {\n        return getResources(parentElement, 'link[rel=stylesheet]', 'href');\n    }\n    function getScripts(parentElement) {\n        return getResources(parentElement, 'script[src]', 'src');\n    }\n    function getFixedUrl(node, attribute) {\n        return '' + (new URL(node.getAttribute(attribute), location.href));\n    }\n    function onLoad() {\n        // console.debug('[singular] before load');\n        const end = SERIES_CALLBACKS.length;\n        let current = -1;\n        let series = Promise.resolve();\n        while (++current < end) {\n            const callback = SERIES_CALLBACKS[current];\n            series = series.then(() => callback());\n        }\n        const prepares = [series];\n        current = PARALLEL_CALLBACKS.length;\n        while (current-- > 0) {\n            prepares[prepares.length] = PARALLEL_CALLBACKS[current]();\n        }\n        SERIES_CALLBACKS = [];\n        PARALLEL_CALLBACKS = [];\n        Promise.all(prepares)\n            .then(onLoading)\n            .catch(catchReload);\n    }\n    function onLoading() {\n        // console.debug('[singular] after load');\n        document.documentElement.style.visibility = 'inherit';\n        try {\n            onLoaded();\n        }\n        catch (reason) {\n            console.warn(reason);\n        }\n    }\n    function catchReload(reason) {\n        console.warn(reason);\n        if (!CONFIGURE.development) {\n            location.reload();\n        }\n    }\n    function onLoaded(changedElement = document.body) {\n        // console.debug('[singular] Loaded');\n        LOADED = true;\n        const page = PAGES[CURRENT_PATH];\n        const callbacks = [\n            ...READY_CALLBACKS.splice(0, READY_CALLBACKS.length),\n            ...LOAD_CALLBACKS,\n            ...page.enterCallbacks\n        ];\n        const end = callbacks.length;\n        let current = -1;\n        while (++current < end) {\n            callbacks[current](changedElement);\n        }\n    }\n})(window, document);\n"],"file":"singular.js"}